{
  "Name": "05 Download Notes files-1",
  "CreationDate": "2022-12-21",
  "Commands": [
    {
      "Command": "open",
      "Target": "https://live.onefile.co.uk/note/notes.aspx?UserID=1492455",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "Find filetype MP4",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=(/descendant:: fieldset[@class=\"attached-file filetype-mp4\"]/a)",
      "Value": "filesCount",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Number of downloadable files = ${filesCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "1",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "(${loopCount} <= ${filesCount})",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Loop number: ${loopCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=(/descendant:: fieldset[@class=\"attached-file filetype-mp4\"]/a)[${loopCount}]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "onDownload",
      "Target": "",
      "Value": "true",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "linkText=Download",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//input[contains(concat(' ',normalize-space(@id),' '),'Preview_Close')]",
      "Value": "",
      "Description": "could also use title=\"Close\" e.g. //*[@title=\"Close\"]"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${loopCount}) + 1;",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Finished MPG downloads",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "Find filetype JPG",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=(/descendant:: fieldset[contains(concat(' ',normalize-space(@class),' '),' attached-file ') and contains(concat(' ',normalize-space(@style),' '),'background-image')]/a)",
      "Value": "filesCount",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Number of downloadable files = ${filesCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "1",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "(${loopCount} <= ${filesCount})",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Loop number: ${loopCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=(/descendant:: fieldset[ contains(concat(' ',normalize-space(@class),' '),' attached-file ') and  contains(concat(' ',normalize-space(@style),' '),'background-image') ]/a)[${loopCount}]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "onDownload",
      "Target": "",
      "Value": "true",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "linkText=Download",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//input[contains(concat(' ',normalize-space(@id),' '),'Preview_Close')]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${loopCount}) + 1;",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Finished JPG downloads",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "Find filetype MSG, PDF",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=(/descendant:: fieldset[ contains(concat(' ',normalize-space(@class),' '),' attached-file ') and  ( contains(concat(' ',normalize-space(@class),' '),' filetype-pdf ') or contains(concat(' ',normalize-space(@class),' '),' filetype-msg ') or contains(concat(' ',normalize-space(@class),' '),' filetype-docx ') or contains(concat(' ',normalize-space(@class),' '),' filetype-xlsx ') or contains(concat(' ',normalize-space(@class),' '),' filetype-zip ') ) ]/a)",
      "Value": "filesCount",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Number of downloadable files = ${filesCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "1",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "while_v2",
      "Target": "(${loopCount} <= ${filesCount})",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Loop number: ${loopCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=(/descendant:: fieldset[ contains(concat(' ',normalize-space(@class),' '),' attached-file ') and  ( contains(concat(' ',normalize-space(@class),' '),' filetype-pdf ') or contains(concat(' ',normalize-space(@class),' '),' filetype-msg ') or contains(concat(' ',normalize-space(@class),' '),' filetype-docx ') or contains(concat(' ',normalize-space(@class),' '),' filetype-xlsx ') or contains(concat(' ',normalize-space(@class),' '),' filetype-zip ') ) ]/a)[${loopCount}]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${loopCount}) + 1;",
      "Value": "loopCount",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Finished MSG, PDF downloads",
      "Value": "",
      "Description": ""
    }
  ]
}
